{% extends 'products/base.html' %}
{% load humanize %}

{% block title %}C·ª≠a H√†ng Tr√°i C√¢y T∆∞∆°i{% endblock %}

{% block content %}
<div class="container my-5">
    <h1 class="text-center mb-4 text-success">üåø C·ª≠a H√†ng Tr√°i C√¢y T∆∞∆°i Ngon</h1>
    <p class="text-center text-muted mb-4">T·∫•t c·∫£ tr√°i c√¢y ƒë·ªÅu ƒë∆∞·ª£c nh·∫≠p t∆∞∆°i m·ªói ng√†y!</p>

    <!-- Thanh t√¨m ki·∫øm -->
    <div class="d-flex justify-content-center mb-5">
        <form method="get" class="d-flex w-100" style="max-width: 600px;">
            <input 
                type="text" 
                name="q" 
                class="form-control me-2" 
                placeholder="T√¨m tr√°i c√¢y (xo√†i, t√°o, cam...)" 
                value="{{ query|default:'' }}"
            >
            <button class="btn btn-success" type="submit">üîç</button>
        </form>
    </div>

    {% if fruits %}
    <div class="row g-4">
        {% for fruit in fruits %}
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm border-0">
                {% if fruit.image %}
                    <div class="fruit-card">
                        <img src="{{ fruit.image.url }}" alt="{{ fruit.name }}">
                    </div>
                {% else %}
                    <div class="fruit-card">
                        <span class="text-muted">Ch∆∞a c√≥ ·∫£nh</span>
                    </div>
                {% endif %}
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">
                        <a href="{% url 'fruit_detail' fruit.id %}" class="text-decoration-none text-dark">
                            {{ fruit.name }}
                        </a>
                    </h5>
                    <p class="card-text flex-grow-1">{{ fruit.description|truncatewords:15 }}</p>
                    <div class="mt-auto">
                        <p class="text-success fw-bold fs-5 mb-2">{{ fruit.price|intcomma }} ‚Ç´/kg</p>
                        <p class="text-muted small mb-3">C√≤n: {{ fruit.stock }} kg</p>
                        <a href="{% url 'add_to_cart' fruit.id %}" class="btn btn-success w-100">‚ûï Th√™m v√†o gi·ªè</a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-5">
        <div class="alert alert-info" role="alert">
            {% if query %}
                üçâ Kh√¥ng t√¨m th·∫•y tr√°i c√¢y n√†o ph√π h·ª£p v·ªõi "{{ query }}". Vui l√≤ng th·ª≠ l·∫°i!
            {% else %}
                üõí Ch∆∞a c√≥ tr√°i c√¢y n√†o trong c·ª≠a h√†ng. Vui l√≤ng quay l·∫°i sau!
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
